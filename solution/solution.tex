\documentclass[12pt,a4paper]{article}
\usepackage[unicode,colorlinks=true]{hyperref}
\usepackage[czech]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage{graphicx}
\textwidth 16cm \textheight 24.6cm
\topmargin -1.3cm
\oddsidemargin 0cm
\usepackage{url}
\usepackage{fancyhdr}
\usepackage{amsmath}
\usepackage{empheq}

\begin{document}

\pagestyle{fancy}     % zapne obyčejné číslování
\setcounter{page}{1}  % nastaví čítač stránek znovu od jedné
\pagenumbering{arabic} % číslování arabskymi číslicemi

\fancyhead[L]{Autorské řešení kvalifikační úlohy z~logiky}
\fancyhead[R]{}

\title{N-trophy$^9$\\Autorské řešení kvalifikační úlohy z~logiky}
\date{\today}
\maketitle

\setlength{\parindent}{0cm}
\setlength{\parskip}{3mm plus2pt minus2pt}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Možná nějaké úvodní kecičky.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Řešení úloh v rovině}
\subsection*{Úroveň 1}

V~této úrovni byly 3 incidenty umístěny do vrcholů rovnostranného trojúhelníku.
Vzdálenostní funkce vypadala takto:
$$E(N) = \frac{|I_1N|^2 + |I_2N|^2 + |I_3N|^2}{3}.$$

Nejprve proveďme nejuniverzálnější úpravu: zjednodušme výraz tak, že z~něj
odstraníme konstanty. To můžeme udělat vždy, protože nás nezajímá konkrétní
hodnota vzdálenostní funkce, ale pouze místo, ve kterém se realizuje optimum.
Dostáváme jednodušší výraz:

$$E(N) = |I_1N|^2 + |I_2N|^2 + |I_3N|^2.$$

Tuto úpravu můžeme udělat v~kterékoliv úrovni, proto ji v~dalším textu budeme
dělat implicitně.

Hledáme tedy bod, který \uv{minimalizuje kvadrát vzdálenosti}. Takový bod bude
nejspíš někde uvnitř trojúhelníka, hledáme jakýsi jeho \uv{střed}. Otázka zní,
jak tento bod najít. V~této úrovni jste měli hodně pokusů, takže jste mohli
prostě zkoušet různé pozice bodů. Možná jste se dostali k~docela dobrému
výsledku, vyvstává však otázka, jestli je vaše řešení skutečně to nejlepší.
Tuto otázku jste mohli zodpovědět analytickým řešením úlohy. Nejprve si rozepišme
funkci $E$ dle Euklidovské vzdálenosti:

\begin{align}
E(N) &= \sqrt{(x_n-x_1)^2 + (y_n - y_1)^2}^2 +
	\sqrt{(x_n-x_2)^2 + (y_n - y_2)^2}^2 +
	\sqrt{(x_n-x_3)^2 + (y_n - y_3)^2}^2 \nonumber \\
E(N) &= (x_n-x_1)^2 + (y_n - y_1)^2 +
	(x_n-x_2)^2 + (y_n - y_2)^2 +
	(x_n-x_3)^2 + (y_n - y_3)^2 \nonumber.
\end{align}

Vidíme, že pro výpočet hodnoty $E$ je možné spočítat nezávisle hodnoty souřadnic
$x$ a $y$. Rozdělíme výpočet tedy na hledání minim dvou funkcí:

\begin{align}
E_x(N) &= (x_n-x_1)^2 + (x_n-x_2)^2 + (x_n-x_3)^2 \nonumber \\
E_y(N) &= (y_n-y_1)^2 + (y_n-y_2)^2 + (y_n-y_3)^2 \nonumber.
\end{align}

Chceme minimalizovat hodnotu funkce $E_x$. Ze školy možná víte, že minimum
funkce se hledá pomocí derivací\footnote{Pokud neumíte derivovat, mohli jste
využít například stránku \url{wolframalpha.com}.}. Pro minimum funkce musí
platit, že v~něm derivace funkce musí být rovna nule. Musí tedy platit:

\begin{align}
\frac{dE}{dN} = 0 &= 2(x_n-x_1) + 2(x_n-x_2) + 2(x_n-x_3) \nonumber \\
0 &= (x_n-x_1) + (x_n-x_2) + (x_n-x_3) \nonumber \\
0 &= 3x_n - (x_1 + x_2 + x_3) \nonumber \\
3x_n &= (x_1 + x_2 + x_3) \nonumber \\
x_n &= \frac{x_1 + x_2 + x_3}{3} \nonumber
\end{align}

Z~výpočtu tedy vychází, že pozice optima je přesně v~aritmetickém průměru
všech bodů\footnote{Pokud bychom měli být úplně matematicky korektní, je třeba
ještě argumentovat, že optimum je pouze jediné a~že se jedná skutečně o~minimum.
To plyne z~tvaru \textit{Hessiánu} gradientu.}. Hodnotu $y_n$ lze vypočítat
úplně stejným postupem- Všimněte si, že získaný výsledek odpovídá přesně
definici těžiště trojúhelníka. Nemocnici je tedy třeba umístit do těžiště
trojúhelníka. Můžeme pokračovat dosazením konkrétních hodnot ze zadání:

\begin{align}
x_n &= \frac{0 + 400 + 200}{3}, y_n = \frac{0 + 0 - 387.3}{3} \nonumber \\
x_n &= 200, y_n = -129.1  \nonumber
\end{align}

Nemocnici tedy umístíme na souřadnice $X=200$, $Y=-129.1$. Hodnota vzdálenostní
funkce pro tuto pozici nemocnice je $60000.29$.

\subsection*{Úroveň 2}
V druhé úrovni bylo potřeba dát pozor na změnu vzdálenostní funkce. Vzhledem k tomu, že se měřila průměrná vzdálenost (ne její kvadrát) od jednotlivých míst incidentů,
nebylo optimem těžiště trojúhelníka. Tentokrát se jednalo o tzv. geometrický medián. Jedná se o právě takový bod $S$ pro který platí, že spojnice $S$ s vrcholy trojúhelníka spolu svírají úhel přesně $120^\circ$.

\subsection*{Úroveň 3}
V~této úrovni bylo potřebu umístit pouze jedinou nemocnici se stejným kritériem
jako v úrovni 1. Řešení je proto v~podstatě stejné jako v~první úrovni, pouze
bylo potřeba zpracovat více dat. S~výhodou se tak dalo využít například Excelu,
nebo jednoduchého programu ve vašem oblíbeném programovacím jazyce.

Na webu \url{https://logika.ntrophy.cz} je k~dispozici příklad programu
v~jazyce Python, kterému stačí argumentem předat jméno csv souboru s~polohami
incidentů a~on vypočte optimální polohu nemocnice.

Výsledné řešení je $X=-3.06$, $Y=-39.85$. Hodnota vzdálenostní funkce pro tuto
pozici nemocnice je $167492.24$.

\subsection*{Úroveň 4}
Tato úroveň se opět podobá úrovni 3, ovšem bylo potřeba umístit více nemocnic.
Více nemocnit úlohu hodně komplikuje, avšak bylo možné si všimnout, že
incidenty jsou rozděleny do shluků (měst), takže je stačilo správně rozdělit do
několika skupin a~každou skupinu vyřešit dle postupu v~úrovni 3. Rozdělení
incidentů do měst jsme dělali ručně, proto níže uvedená hodnota nemusí být
skutečným optimem. Měla by ale být poměrně blízko optima :).

\begin{figure}[ht]
\centering
\includegraphics[width=0.5\textwidth]{level4.pdf}
\caption{Rozdělení incidentů do měst ve 4. úrovni.}
\end{figure}

Souřadnice nemocnic:
\begin{verbatim}
-349.93,339.53
360.53,328.13
181.73,-390.27
-369.38,-178.00
-66.00,-291.00
358.24,-270.24
-62.46,-36.46
127.62,55.00
-144.36,340.09
\end{verbatim}

Hodnota vzdálenostní funkce pro tyto souřadnice je $6208.63$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Řešení úloh na mapě silnic}
\subsection*{Úroveň 5, 6}
Nejříve si představme, že všehny body událostí jsou umístěny někde na přímce. Když umístíme nemocnici kamkoli na tuto přímku, získáme nějakou hodnotu vzdálenostní funkce.
Nyní se tuto hodnotu pokusíme optimalizovat. Pozice nemocnice dělí přímku na dvě poloviny, a tydy rozděluje i pozice incidentů na skupinu vlevo a skupinu vpravo.
Nyní předpokládejme, že například ve skupině vlevo se nechází více incidentu než vrpavo. Pak posun o malý kousek vlevo zmenší hodnotu vzdálenostní funkce za každý incident vlevo a zvětší její hodnotu za každý incident vpravo.
Protože je ovšem incidentů vlevo více než vpravo, celková změna bude záporná. Proto takto múžeme posouvat stanici až do místa, kde bude množina vlevo i vpravo stejně velká.
V tomto bodě je hodnot a vzdálenostní funkce určitě minimální.

Podobnou úvaho uvšem můžeme provést i pro síť silnic. Pokud se totiž nacházíme s nemocnicí na nějaké cestě, tak rozdělí celou síť na dvě poloviny. Nemocnici posuneme tím směrem, kde se nachází více bodů.
Tento postup nás vždy dovede no optimální pozice pro nemocnici.

\subsection*{Úroveň 7}
V této úrovni šlo aplikovat naprosto stejný postup, jako v úrovni 5 a 6. Stačilo si uvědomit, že úvaha nezávisí na délce spojnic. Posunout se směrem k většímu počtu vrcholů se nám vyplatí vždy pro libovolně dlouhou spojnici dvou incidentů.

\subsection*{Úroveň 8}
V 8. úrovni již bylo potřeba řešení z úrovně 7 trochu poupravit. Váhy jednotlivých incidentů nabourávají naši úvahu o přibližování se té straně, na které se nachází více incidentů.
Ta lze však jednoduše upravit tak, že si například místo jediného incidentu o velikosti pět představím pět incidentů o velikosti jedna. Takto pouze při rozhodování, na kterou stranu silnice půjdeme, budeme přihlížet také k váze jednotlivých incidentů a místo počtu incidentů na každé straně budeme počítat součet jejich vah.

\subsection*{Úroveň 9, 10}
Podobně jako v úrovni 4 hlavní myšlenkou úrovně bylo opět rozdělit incidenty do tří sití, které se následně řešily postupem z předchozích úrovní. V úrovni 10 mělo být ovšem umístěno tolik nemocnic, že optimální rozdelení na podsítě téměř nebylo možné pouze ručně. S výhodou se tak dalo využít dynamického programování pro získání optimální polohy. Rozumně blízko optimu se šlo ovšem samozřejmě přiblížit i pouhým zkoušením rozdělení na podsítě.

\end{document}
